{"ast":null,"code":"import _slicedToArray from \"/home/niveus/3d walk/x/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectWithoutProperties from \"/home/niveus/3d walk/x/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"scale\", \"frames\", \"opacity\", \"width\", \"height\", \"blur\", \"far\", \"resolution\", \"smooth\"];\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport * as THREE from 'three';\nimport { useThree, useFrame } from '@react-three/fiber';\nimport { HorizontalBlurShader, VerticalBlurShader } from 'three-stdlib';\nvar ContactShadows = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var scale = _ref.scale,\n      _ref$frames = _ref.frames,\n      frames = _ref$frames === void 0 ? Infinity : _ref$frames,\n      _ref$opacity = _ref.opacity,\n      opacity = _ref$opacity === void 0 ? 1 : _ref$opacity,\n      _ref$width = _ref.width,\n      width = _ref$width === void 0 ? 1 : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === void 0 ? 1 : _ref$height,\n      _ref$blur = _ref.blur,\n      blur = _ref$blur === void 0 ? 1 : _ref$blur,\n      _ref$far = _ref.far,\n      far = _ref$far === void 0 ? 10 : _ref$far,\n      _ref$resolution = _ref.resolution,\n      resolution = _ref$resolution === void 0 ? 256 : _ref$resolution,\n      _ref$smooth = _ref.smooth,\n      smooth = _ref$smooth === void 0 ? true : _ref$smooth,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  var scene = useThree(function (_ref2) {\n    var scene = _ref2.scene;\n    return scene;\n  });\n  var gl = useThree(function (_ref3) {\n    var gl = _ref3.gl;\n    return gl;\n  });\n  var shadowCamera = React.useRef(null);\n  width = width * (Array.isArray(scale) ? scale[0] : scale || 1);\n  height = height * (Array.isArray(scale) ? scale[1] : scale || 1);\n\n  var _React$useMemo = React.useMemo(function () {\n    var renderTarget = new THREE.WebGLRenderTarget(resolution, resolution);\n    var renderTargetBlur = new THREE.WebGLRenderTarget(resolution, resolution);\n    renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n    var planeGeometry = new THREE.PlaneBufferGeometry(width, height).rotateX(Math.PI / 2);\n    var blurPlane = new THREE.Mesh(planeGeometry);\n    var depthMaterial = new THREE.MeshDepthMaterial();\n    depthMaterial.depthTest = depthMaterial.depthWrite = false;\n\n    depthMaterial.onBeforeCompile = function (shader) {\n      return shader.fragmentShader = shader.fragmentShader.replace('1.0 - fragCoordZ ), opacity );', '0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );');\n    };\n\n    var horizontalBlurMaterial = new THREE.ShaderMaterial(HorizontalBlurShader);\n    var verticalBlurMaterial = new THREE.ShaderMaterial(VerticalBlurShader);\n    verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n    return [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur];\n  }, [resolution, width, height, scale]),\n      _React$useMemo2 = _slicedToArray(_React$useMemo, 7),\n      renderTarget = _React$useMemo2[0],\n      planeGeometry = _React$useMemo2[1],\n      depthMaterial = _React$useMemo2[2],\n      blurPlane = _React$useMemo2[3],\n      horizontalBlurMaterial = _React$useMemo2[4],\n      verticalBlurMaterial = _React$useMemo2[5],\n      renderTargetBlur = _React$useMemo2[6];\n\n  var blurShadows = React.useCallback(function (blur) {\n    blurPlane.visible = true;\n    blurPlane.material = horizontalBlurMaterial;\n    horizontalBlurMaterial.uniforms.tDiffuse.value = renderTarget.texture;\n    horizontalBlurMaterial.uniforms.h.value = blur * 1 / 256;\n    gl.setRenderTarget(renderTargetBlur);\n    gl.render(blurPlane, shadowCamera.current);\n    blurPlane.material = verticalBlurMaterial;\n    verticalBlurMaterial.uniforms.tDiffuse.value = renderTargetBlur.texture;\n    verticalBlurMaterial.uniforms.v.value = blur * 1 / 256;\n    gl.setRenderTarget(renderTarget);\n    gl.render(blurPlane, shadowCamera.current);\n    blurPlane.visible = false;\n  }, []);\n  var count = 0;\n  useFrame(function () {\n    if (shadowCamera.current && (frames === Infinity || count < frames)) {\n      var initialBackground = scene.background;\n      scene.background = null;\n      var initialOverrideMaterial = scene.overrideMaterial;\n      scene.overrideMaterial = depthMaterial;\n      gl.setRenderTarget(renderTarget);\n      gl.render(scene, shadowCamera.current);\n      scene.overrideMaterial = initialOverrideMaterial;\n      blurShadows(blur);\n      if (smooth) blurShadows(blur * 0.4);\n      gl.setRenderTarget(null);\n      scene.background = initialBackground;\n      count++;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({\n    \"rotation-x\": Math.PI / 2\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    geometry: planeGeometry,\n    scale: [1, -1, 1],\n    rotation: [-Math.PI / 2, 0, 0]\n  }, /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    map: renderTarget.texture,\n    transparent: true,\n    opacity: opacity\n  })), /*#__PURE__*/React.createElement(\"orthographicCamera\", {\n    ref: shadowCamera,\n    args: [-width / 2, width / 2, height / 2, -height / 2, 0, far]\n  }));\n});\nexport { ContactShadows };","map":{"version":3,"names":["_extends","React","THREE","useThree","useFrame","HorizontalBlurShader","VerticalBlurShader","ContactShadows","forwardRef","ref","scale","frames","Infinity","opacity","width","height","blur","far","resolution","smooth","props","scene","gl","shadowCamera","useRef","Array","isArray","useMemo","renderTarget","WebGLRenderTarget","renderTargetBlur","texture","generateMipmaps","planeGeometry","PlaneBufferGeometry","rotateX","Math","PI","blurPlane","Mesh","depthMaterial","MeshDepthMaterial","depthTest","depthWrite","onBeforeCompile","shader","fragmentShader","replace","horizontalBlurMaterial","ShaderMaterial","verticalBlurMaterial","blurShadows","useCallback","visible","material","uniforms","tDiffuse","value","h","setRenderTarget","render","current","v","count","initialBackground","background","initialOverrideMaterial","overrideMaterial","createElement","geometry","rotation","map","transparent","args"],"sources":["/home/niveus/3d walk/x/node_modules/@react-three/drei/core/ContactShadows.js"],"sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport * as THREE from 'three';\nimport { useThree, useFrame } from '@react-three/fiber';\nimport { HorizontalBlurShader, VerticalBlurShader } from 'three-stdlib';\n\nconst ContactShadows = /*#__PURE__*/React.forwardRef(({\n  scale,\n  frames = Infinity,\n  opacity = 1,\n  width = 1,\n  height = 1,\n  blur = 1,\n  far = 10,\n  resolution = 256,\n  smooth = true,\n  ...props\n}, ref) => {\n  const scene = useThree(({\n    scene\n  }) => scene);\n  const gl = useThree(({\n    gl\n  }) => gl);\n  const shadowCamera = React.useRef(null);\n  width = width * (Array.isArray(scale) ? scale[0] : scale || 1);\n  height = height * (Array.isArray(scale) ? scale[1] : scale || 1);\n  const [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur] = React.useMemo(() => {\n    const renderTarget = new THREE.WebGLRenderTarget(resolution, resolution);\n    const renderTargetBlur = new THREE.WebGLRenderTarget(resolution, resolution);\n    renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n    const planeGeometry = new THREE.PlaneBufferGeometry(width, height).rotateX(Math.PI / 2);\n    const blurPlane = new THREE.Mesh(planeGeometry);\n    const depthMaterial = new THREE.MeshDepthMaterial();\n    depthMaterial.depthTest = depthMaterial.depthWrite = false;\n\n    depthMaterial.onBeforeCompile = shader => shader.fragmentShader = shader.fragmentShader.replace('1.0 - fragCoordZ ), opacity );', '0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );');\n\n    const horizontalBlurMaterial = new THREE.ShaderMaterial(HorizontalBlurShader);\n    const verticalBlurMaterial = new THREE.ShaderMaterial(VerticalBlurShader);\n    verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n    return [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur];\n  }, [resolution, width, height, scale]);\n  const blurShadows = React.useCallback(blur => {\n    blurPlane.visible = true;\n    blurPlane.material = horizontalBlurMaterial;\n    horizontalBlurMaterial.uniforms.tDiffuse.value = renderTarget.texture;\n    horizontalBlurMaterial.uniforms.h.value = blur * 1 / 256;\n    gl.setRenderTarget(renderTargetBlur);\n    gl.render(blurPlane, shadowCamera.current);\n    blurPlane.material = verticalBlurMaterial;\n    verticalBlurMaterial.uniforms.tDiffuse.value = renderTargetBlur.texture;\n    verticalBlurMaterial.uniforms.v.value = blur * 1 / 256;\n    gl.setRenderTarget(renderTarget);\n    gl.render(blurPlane, shadowCamera.current);\n    blurPlane.visible = false;\n  }, []);\n  let count = 0;\n  useFrame(() => {\n    if (shadowCamera.current && (frames === Infinity || count < frames)) {\n      const initialBackground = scene.background;\n      scene.background = null;\n      const initialOverrideMaterial = scene.overrideMaterial;\n      scene.overrideMaterial = depthMaterial;\n      gl.setRenderTarget(renderTarget);\n      gl.render(scene, shadowCamera.current);\n      scene.overrideMaterial = initialOverrideMaterial;\n      blurShadows(blur);\n      if (smooth) blurShadows(blur * 0.4);\n      gl.setRenderTarget(null);\n      scene.background = initialBackground;\n      count++;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({\n    \"rotation-x\": Math.PI / 2\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    geometry: planeGeometry,\n    scale: [1, -1, 1],\n    rotation: [-Math.PI / 2, 0, 0]\n  }, /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    map: renderTarget.texture,\n    transparent: true,\n    opacity: opacity\n  })), /*#__PURE__*/React.createElement(\"orthographicCamera\", {\n    ref: shadowCamera,\n    args: [-width / 2, width / 2, height / 2, -height / 2, 0, far]\n  }));\n});\n\nexport { ContactShadows };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}